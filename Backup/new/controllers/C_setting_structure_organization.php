<?php
//-----------------------------------------------------------------------------------------------//
defined('BASEPATH') OR exit('No direct script access allowed');
//-----------------------------------------------------------------------------------------------//
class C_setting_structure_organization extends CI_Controller {
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	public function __construct(){
        parent::__construct();
		
		if($this->session->userdata('session_bgm_edocument_status') != "LOGIN"){
			redirect(base_url("C_index"));
		}
    }
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	public function index(){
		$this->load->view('V_setting_structure_organization');
	}
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	public function insert(){
		if($_SERVER['REQUEST_METHOD']!="POST"){
			echo '
				<script>
					alert("UNKNOWN COMMAND");
					window.location.href = "'.base_url('C_setting_structure_organization').'";
				</script>
			';
			exit();
		}
		//-----------------------------------------------------------------------------------------------//
		$si_code = $this->input->post('si_code');
		$si_nama = $this->input->post('si_nama');
		$si_level = $this->input->post('si_level');
		$si_parent = $this->input->post('si_parent');
		$si_desc = $this->input->post('si_desc');
		$si_userid = $this->input->post('si_userid');
		
		$date_now = date('Y-m-d H:i:s');
		//-----------------------------------------------------------------------------------------------//
		$data_insert = array(
			'SEON_ID' => $si_code,
			'SEON_NAME' => $si_nama,
			'SEON_LEVEL' => $si_level,
			'SEON_PARENT' => $si_parent,
			'SEON_DESC' => $si_desc,
			'SEON_DATE' => $date_now,
			'UR_ID' => $si_userid
		);
		//-----------------------------------------------------------------------------------------------//
		$is_ok = $this->M_library_database->DB_INSERT_DATA_STRUCTURE_ORGANIZATION($data_insert);
		//-----------------------------------------------------------------------------------------------//
		if($is_ok){
			//INSERT TO LOG ???
			//-----------------------------------------------------------------------------------------------//
			echo '
				<script>
					alert("Penambahan Data Berhasil");
					window.location.href = "'.base_url('C_setting_structure_organization').'";
				</script>
			';
			exit();
		}else{
			echo '
				<script>
					alert("Penambahan Data Gagal, Mohon Cek Kembali");
					window.location.href = "'.base_url('C_setting_structure_organization').'";
				</script>
			';
			exit();
		}
	}
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	public function tool_table(){
		if($_SERVER['REQUEST_METHOD']!="POST"){
			echo '
				<script>
					alert("UNKNOWN COMMAND");
					window.location.href = "'.base_url('C_setting_structure_organization').'";
				</script>
			';
			exit();
		}
		//-----------------------------------------------------------------------------------------------//
		$si_tool_table_key = $this->input->post('si_tool_table_key');
		$si_tool_table_key = $si_tool_table_key[0];
		//-----------------------------------------------------------------------------------------------//
		if(isset($_POST['btn_delete'])){
			$is_ok = $this->M_library_database->DB_DELETE_DATA_STRUCTURE_ORGANIZATION($si_tool_table_key);
			//-----------------------------------------------------------------------------------------------//
			if($is_ok){
				//INSERT TO LOG ???
				//-----------------------------------------------------------------------------------------------//
				echo '
					<script>
						alert("Hapus Data Berhasil");
						window.location.href = "'.base_url('C_setting_structure_organization').'";
					</script>
				';
				exit();
			}else{
				echo '
					<script>
						alert("Hapus Data Gagal, Mohon Cek Kembali");
						window.location.href = "'.base_url('C_setting_structure_organization').'";
					</script>
				';
				exit();
			}
		}else{
			echo '
				<script>
					alert("UNKNOWN COMMAND");
					window.location.href = "'.base_url('C_setting_structure_organization').'";
				</script>
			';
			exit();
		}
	}
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
	//-----------------------------------------------------------------------------------------------//
}
//-----------------------------------------------------------------------------------------------//
